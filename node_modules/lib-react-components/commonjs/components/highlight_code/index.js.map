{"version":3,"sources":["../../../src/components/highlight_code/index.jsx"],"names":["HighlightCode","Prism","hooks","add","env","code","element","innerText","children","props","Array","isArray","join","String","lang","grammar","languages","_html","_getPlainCode","highlight","err","console","warn","replace","s","charCodeAt","repeat","str","length","other","className","whiteSpace","node","rootNode","__html","_hightlight","PureComponent","propTypes","PropTypes","isRequired","oneOf","defaultProps"],"mappings":";;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;AAEA;;;IAGqBA,a;;;;;;;;;;;;;AA6BnB;;;;yCAIqB;AACnBC,wBAAMC,KAAN,CAAYC,GAAZ,CAAgB,kBAAhB,EAAoC,UAACC,GAAD,EAAS;AAC3CA,YAAIC,IAAJ,GAAWD,IAAIE,OAAJ,CAAYC,SAAvB;AACD,OAFD;AAGD;;;oCAEe;AACd,UAAMC,WAAW,KAAKC,KAAL,CAAWD,QAA5B;;AAEA,UAAIE,MAAMC,OAAN,CAAcH,QAAd,CAAJ,EAA6B;AAC3B,eAAOA,SAASI,IAAT,CAAc,GAAd,CAAP;AACD;;AAED,aAAOC,OAAOL,QAAP,CAAP;AACD;;AAED;;;;;;kCAGc;AAAA,UACJM,IADI,GACK,KAAKL,KADV,CACJK,IADI;;AAEZ,UAAMC,UAAUd,kBAAMe,SAAN,CAAgBF,IAAhB,CAAhB;AACA,UAAIG,QAAQ,KAAKC,aAAL,EAAZ;;AAEA,UAAIH,OAAJ,EAAa;AACX,YAAI;AACFE,kBAAQhB,kBAAMkB,SAAN,CAAgBF,KAAhB,EAAuBF,OAAvB,EAAgCD,IAAhC,CAAR;AACD,SAFD,CAEE,OAAOM,GAAP,EAAY;AACZC,kBAAQC,IAAR,wEAAkFR,IAAlF,EAA0FM,GAA1F;AACD;AACF,OAND,MAMO;AACLH,gBAAQA,MAAMM,OAAN,CAAc,OAAd,EAAuB;AAAA,wBAAUC,EAAEC,UAAF,CAAa,CAAb,CAAV;AAAA,SAAvB,CAAR;AACD;;AAED;AACA,aAAOR,MACJM,OADI,CACI,KADJ,EACW,MADX,EAEJA,OAFI,CAEI,WAFJ,EAEiB;AAAA,wBAAc,SAASG,MAAT,CAAgBC,IAAIC,MAAJ,GAAa,CAA7B,CAAd;AAAA,OAFjB,EAGJL,OAHI,CAGI,QAHJ,EAGc;AAAA,eAAO,SAASG,MAAT,CAAgBC,IAAIC,MAApB,CAAP;AAAA,OAHd,CAAP;AAID;;AAED;;;;;;;6BAIS;AAAA;;AAAA,mBAKH,KAAKnB,KALF;AAAA,UAELD,QAFK,UAELA,QAFK;AAAA,UAGLM,IAHK,UAGLA,IAHK;AAAA,UAIFe,KAJE;;AAOP,aACE;AAAA;AAAA;AACE,4BAAe;AADjB,WAEMA,KAFN;AAGE,qBAAW,0BACTA,MAAMC,SADG,gBAEGhB,IAFH;AAHb;AAQE;AACE,iBAAO;AACLiB,wBAAY;AADP,WADT;AAIE,eAAK,aAACC,IAAD,EAAU;AAAE,mBAAKC,QAAL,GAAgBD,IAAhB;AAAuB,WAJ1C;AAKE,mCAAuBlB,IALzB;AAME,mCAAyB,EAAEoB,QAAQ,KAAKC,WAAL,EAAV;AAN3B;AARF,OADF;AAmBD;;;;EAxGwCC,oB;;AAAtBpC,a,CACZqC,S,GAAY;AACjB;;;AAGA7B,YAAU8B,oBAAUN,IAAV,CAAeO,UAJR;AAKjB;;;AAGAzB,QAAMwB,oBAAUE,KAAV,CAAgB,CACpB,KADoB,EAEpB,MAFoB,EAGpB,YAHoB,EAIpB,IAJoB,EAKpB,KALoB,EAMpB,QANoB,EAOpB,KAPoB,EAQpB,KARoB,EASpB,MAToB,EAUpB,MAVoB,EAWpB,MAXoB,EAYpB,MAZoB,CAAhB;AARW,C;AADAxC,a,CAyBZyC,Y,GAAe;AACpB3B,QAAM,IADc,E;kBAzBHd,a","file":"index.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport PropTypes from 'prop-types';\nimport Prism from 'prismjs';\nimport classNames from 'classnames';\nimport 'prismjs/components/prism-jsx';\nimport 'prismjs/components/prism-bash';\nimport 'prismjs/components/prism-glsl';\nimport 'prismjs/components/prism-json';\n\n/**\n * Highlight component\n */\nexport default class HighlightCode extends PureComponent {\n  static propTypes = {\n    /**\n     * This is what will be displayed inside the component\n     */\n    children: PropTypes.node.isRequired,\n    /**\n     * Supported highlighting languages\n     */\n    lang: PropTypes.oneOf([\n      'css',\n      'html',\n      'javascript',\n      'js',\n      'jsx',\n      'markup',\n      'svg',\n      'xml',\n      'bash',\n      'glsl',\n      'none',\n      'json',\n    ]),\n  };\n\n  static defaultProps = {\n    lang: 'js',\n  }\n\n  /**\n   * Fix Prism removes <br/> on Prism.highlightAll()\n   * https://github.com/PrismJS/prism/issues/832\n   */\n  componentWillMount() {\n    Prism.hooks.add('before-highlight', (env) => {\n      env.code = env.element.innerText;\n    });\n  }\n\n  _getPlainCode() {\n    const children = this.props.children;\n\n    if (Array.isArray(children)) {\n      return children.join(' ');\n    }\n\n    return String(children);\n  }\n\n  /**\n   * Hightlight element\n   */\n  _hightlight() {\n    const { lang } = this.props;\n    const grammar = Prism.languages[lang];\n    let _html = this._getPlainCode();\n\n    if (grammar) {\n      try {\n        _html = Prism.highlight(_html, grammar, lang);\n      } catch (err) {\n        console.warn(`React Components Highlighter: There is an error highlighting lang ${lang}`, err);\n      }\n    } else {\n      _html = _html.replace(/[<>]/g, s => `&#${s.charCodeAt(0)};`);\n    }\n\n    // Treat iOS whie-space: pre; behavior\n    return _html\n      .replace(/\\n/g, '<br>')\n      .replace(/<br>[ ]+/g, str => `<br>${'&nbsp;'.repeat(str.length - 5)}`)\n      .replace(/^[ ]+/g, str => '&nbsp;'.repeat(str.length));\n  }\n\n  /**\n   * render\n   * @return {ReactElement} markup\n   */\n  render() {\n    const {\n      children,\n      lang,\n      ...other\n    } = this.props;\n\n    return (\n      <pre\n        data-component=\"highlight_code\"\n        {...other}\n        className={classNames(\n          other.className,\n          `language-${lang}`,\n        )}\n      >\n        <code\n          style={{\n            whiteSpace: 'nowrap',\n          }}\n          ref={(node) => { this.rootNode = node; }}\n          className={`language-${lang}`}\n          dangerouslySetInnerHTML={{ __html: this._hightlight() }}\n        />\n      </pre>\n    );\n  }\n}\n"]}